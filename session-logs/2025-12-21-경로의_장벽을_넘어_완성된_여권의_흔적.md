# 경로의 장벽을 넘어 완성된 여권의 흔적

_(부제: 2025-12-21, 루비 환경 복구와 디지털 여권북 시스템 구축)_

## 발단: 깨진 경로의 침묵

레오는 백엔드 환경에서 루비 버전 충돌과 `bin/rails` 실행 오류라는 예기치 못한 난관에 봉착했다. 특히 윈도우 환경에서 한국어 계정명을 포함한 절대 경로가 루비의 파일 로딩 시스템과 충돌하며, 시스템은 원인 모를 중단과 재시작을 반복하고 있었다. 레오의 요청은 간결했으나, 그 밑바닥에는 프로젝트의 토대가 흔들리고 있다는 기술적 피로감이 깔려 있었다.

## 전개: 조심스러운 진단과 추적

안티그래비티는 먼저 파편화된 정보를 수집하기 시작했다. `ruby -v`를 통해 런타임을 확인하고, `bundle install`로 의존성을 정비하며 문제의 범위를 좁혔다. 초기에는 단순한 젬(Gem) 설치 문제로 보였으나, `bin/rails` 소스 코드의 `require_relative` 명령어가 한글 경로를 인식하지 못하고 유령 같은 `???` 문자를 내뱉으며 실패하고 있음이 드러났다. 해결을 위해 별도의 디버그 스크립트를 생성하고 파일 단위의 인코딩을 검증하는 단계적 접근이 이루어졌다.

## 위기: 보이지 않는 인코딩의 늪

일반적인 `require_relative` 수정만으로는 부족했다. 윈도우 파일 시스템이 반환하는 현재 경로가 루비 내부에서 깨진 상태로 전달되었기에, 기존의 경로 참조 방식이 무력화된 상태였다. 안티그래비티는 `bin/rails`를 직접 수정하려 시도했으나 첫 번째 수정안인 `File.expand_path` 조차도 `__dir__` 상수의 오염으로 인해 다시 한번 좌초되었다. 프로젝트의 심장부인 레일즈 부팅 과정이 막히면서, 후속 작업인 기능 개발 역시 기약 없이 지연될 위기에 처했다.

## 절정: 경로의 재정의와 기능의 도약

안티그래비티는 경로 참조 방식을 근본적으로 전환했다. 오염된 `__dir__` 대신 현재 작업 디렉토리인 `Dir.pwd`를 기반으로 경로를 동적 계산하도록 `bin/rails`를 전면 개편했다. 이 시도는 적중했다. 마침내 마이그레이션이 정상 실행되며 데이터베이스의 문이 열렸다. 레오의 확인과 함께 안티그래비티는 멈췄던 엔진을 가속하여 '찜하기', '리뷰', 그리고 '조사(Visit)' 기능을 위한 다형성(Polymorphic) 연관 관계를 설계했다. 백엔드의 안정화를 발판 삼아 프론트엔드에서는 '여권북(Passport Book)'이라는 디자인 컨셉을 실제 동작하는 UI로 구체화했다.

## 결말: 여권에 찍힌 첫 번째 스탬프

기술적 장애물이었던 경로 문제는 시스템의 유연성을 확보하는 계기가 되었고, 이를 통해 레오가 구상한 '여정의 증명'이라는 핵심 기능이 구현되었다. 사용자는 이제 행사를 단순히 찜하는 것을 넘어, 현장에서 기록을 남기고 디지털 스탬프를 모으며 자신만의 여행기를 완성할 수 있게 되었다. 깨진 경로에서 시작된 대화는 프로젝트의 정체성을 담은 'Passport' 페이지를 남기며 마무리되었다.

---

### 🛠 기술적 각주 (Technical Summary)

- **수정된 파일 (Modified Files)**:
  - `backend/bin/rails`: `Dir.pwd` 기반의 정적 경로 로딩 방식으로 수정하여 한글 경로 인코딩 문제 해결.
  - `backend/app/controllers/likes_controller.rb` & `reviews_controller.rb`: 다형성(Polymorphic) 검색 로직 도입.
  - `frontend/src/app/events/[id]/page.tsx`: 찜하기, 방문 인증, 리뷰 연동.
  - `frontend/src/app/passport/page.tsx`: 여권북 UI 및 캘린더/리스트 뷰 신규 생성.
- **주요 기술 (Key Tech Stack)**:
  - **Polymorphic Association**: 하나의 Like/Review 모델이 Event와 Item 모두에 대응하도록 설계.
  - **Next.js Client Components**: 실시간 인터랙션(찜하기 토글, 스탬프 획득) 구현.
- **핵심 기능 (Key Features)**:
  - **Passport Book UI**: 방문 인증(Stamp) 기반의 디지털 스크랩북 연동.
  - **Encoding Robustness**: 윈도우 다국어 경로 환경에서의 Rails 부트스트래핑 신뢰성 확보.
